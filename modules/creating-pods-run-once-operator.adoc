// Module included in the following assemblies:
//
// * nodes/pods/run_once_duration_override/run-once-duration-override-configuring.adoc

:_content-type: PROCEDURE
[id="run-once-operator-creating-pods-cli_{context}"]
= Using the {run-once-operator} through OpenShift CLI

You can use the OpenShift command line interface (CLI) to create pods with the {run-once-operator}.

.Prerequisites

* You have created a namespace titled `openshift-run-once-duration-override-operator`.
* You have installed the {run-once-operator}.
* You have access to the {product-title} web console.
//Do you need to have created an instance first?
.Procedure

. Log in to the OpenSift CLI.
//The test cast has "create a new project" as the next step but if project and namespace are the same thing then I'm starting the instructions with the namespace they already needed to create. Verify if this is the case.
. Label the `openshift-run-once-duration-override-operator` namespace.
+
[source,terminal]
----
$ oc label ns openshift-run-once-duration-override-operator runoncedurationoverrides.admission.runoncedurationoverride.openshift.io/enabled=true
----
+
. Create a YAML file and edit the `activeDeadlineSeconds` field to your desired value.
+
[source,yaml]
----
apiVersion: v1
kind: Pod
metadata:
  name: <name>
  namespace: <namespace>
spec:
  activeDeadlineSeconds: <time_to_failure> <1>
  restartPolicy: OnFailure
  containers:
    - name: <name>
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop: ["ALL"]
        runAsNonRoot:
          true
        seccompProfile:
          type: "RuntimeDefault"
      image: <image>
      command:
        - /bin/sh
        - -ec
        - |
          while sleep 5; do date; done
----
<1> Overrides the default active deadline seconds and replaces it with your specified time. Note that the value of the override must be specified in string form.
//Should it be activeDeadLineSeconds?
//The value being in string form is from the 3.11 docs. Verify if true.
//I'm unsure of the sample values for the YAML file.

.Verification

. Log in to the OpenShift CLI.
. Check to see that the active deadline seconds is set to the desired value.
+
[source,terminal]
----
$ oc get pods -n <name> -o json | jq '.items[0].spec.activeDeadlineSeconds'
----
+
//I think the above command is wrong. It comes from the test cases.
//oc get pods -n knarra -o json | jq '.items[0].spec.activeDeadlineSeconds'
. Run the command again once the deadline has passed to verify that the pod is in an error state.
+
[source,terminal]
----
$ oc get pod <name> -n <namespace>
----
+
.Example output
[source,text]
----
NAME       READY   STATUS   RESTARTS   AGE
<name>   0/1     Error    0          10m
----
